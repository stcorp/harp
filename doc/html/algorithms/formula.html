<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Common formula &mdash; HARP 1.27 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="next" title="Regridding operations" href="regridding.html" />
    <link rel="prev" title="Definitions" href="definitions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HARP
          </a>
              <div class="version">
                1.27
              </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions/index.html">Conventions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Algorithms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="definitions.html">Definitions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Common formula</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gravity">gravity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geopotential-height">geopotential height</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gas-constant">gas constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal-gas-law">ideal gas law</a></li>
<li class="toctree-l3"><a class="reference internal" href="#barometric-formula">barometric formula</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-density">mass density</a></li>
<li class="toctree-l3"><a class="reference internal" href="#number-density">number density</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dry-air-vs-total-air">dry air vs. total air</a></li>
<li class="toctree-l3"><a class="reference internal" href="#virtual-temperature">virtual temperature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#volume-mixing-ratio">volume mixing ratio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-mixing-ratio">mass mixing ratio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molar-mass-of-total-air">molar mass of total air</a></li>
<li class="toctree-l3"><a class="reference internal" href="#partial-pressure">partial pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saturated-water-vapor-pressure">saturated water vapor pressure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="regridding.html">Regridding operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#variable-conversions">Variable Conversions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ingestions/index.html">Ingestion definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libharp.html">C library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../idl.html">IDL interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab.html">MATLAB interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python.html">Python interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../R.html">R interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Command line tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HARP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Algorithms</a></li>
      <li class="breadcrumb-item active">Common formula</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="common-formula">
<h1>Common formula</h1>
<section id="gravity">
<h2>gravity</h2>
<ol class="arabic">
<li><p>Newtonâ€™s gravitational law</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>description</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g\)</span></p></td>
<td><p>normal gravity at sea level</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g_{h}\)</span></p></td>
<td><p>gravity at specific height</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td><p>altitude</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>local earth curvature radius</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[g_{h} = g\left(\frac{R}{R + z}\right)^2\]</div>
</li>
<li><p>Normal gravity at sea level ellipsoid</p>
<p>This is the WGS84 ellipsoidal gravity formula as taken from NIMA TR8350.2</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><p>WGS84 semi-major axis</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(b\)</span></p></td>
<td><p>WGS84 semi-minor axis</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(e\)</span></p></td>
<td><p>eccentricity</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g\)</span></p></td>
<td><p>normal gravity at sea level</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g_{e}\)</span></p></td>
<td><p>gravity at equator</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g_{p}\)</span></p></td>
<td><p>gravity at poles</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\phi\)</span></p></td>
<td><p>latitude</p></td>
<td><p><span class="math notranslate nohighlight">\(degN\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   e^2 &amp; = &amp; \frac{a^2-b^2}{a^2} \\
   k &amp; = &amp; \frac{bg_{p} - ag_{e}}{ag_{e}} \\
   g &amp; = &amp; g_{e}\frac{1 + k {\sin}^2(\frac{\pi}{180}\phi)}{\sqrt{1 - e^2{\sin}^2(\frac{\pi}{180}\phi)}} \\
   g &amp; = &amp; 9.7803253359 \frac{1 + 0.00193185265241{\sin}^2(\frac{\pi}{180}\phi)}
      {\sqrt{1 - 0.00669437999013{\sin}^2(\frac{\pi}{180}\phi)}}
\end{eqnarray}</div></li>
<li><p>Gravity at specific altitude</p>
<p>This is the WGS84 ellipsoidal gravity formula as taken from NIMA TR8350.2</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><p>WGS84 semi-major axis</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(b\)</span></p></td>
<td><p>WGS84 semi-minor axis</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f\)</span></p></td>
<td><p>WGS84 flattening</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g\)</span></p></td>
<td><p>normal gravity at sea level</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g_{h}\)</span></p></td>
<td><p>gravity at specific height</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(GM\)</span></p></td>
<td><p>WGS84 earthâ€™s gravitational constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m^3}{s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td><p>altitude</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\phi\)</span></p></td>
<td><p>latitude</p></td>
<td><p><span class="math notranslate nohighlight">\(degN\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\omega\)</span></p></td>
<td><p>WGS84 earth angular velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(rad/s\)</span></p></td>
</tr>
</tbody>
</table>
<p>The formula used is the one based on the truncated Taylor series expansion:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   m &amp; = &amp; \frac{\omega^2a^2b}{GM} \\
   g_{h} &amp; = &amp; g \left[ 1 - \frac{2}{a}\left(1+f+m-2f{\sin}^2(\frac{\pi}{180}\phi)\right)z + \frac{3}{a^2}z^2 \right] \\
\end{eqnarray}</div></li>
</ol>
</section>
<section id="geopotential-height">
<h2>geopotential height</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>description</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g\)</span></p></td>
<td><p>normal gravity at sea level</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g_{0}\)</span></p></td>
<td><p>mean earth gravity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g_{h}\)</span></p></td>
<td><p>gravity at specific height</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>local earth curvature radius</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td><p>altitude</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z_{g}\)</span></p></td>
<td><p>geopotential height</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\phi\)</span></p></td>
<td><p>latitude</p></td>
<td><p><span class="math notranslate nohighlight">\(degN\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>mass density</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The geopotential height allows the gravity in the hydrostatic equation</p>
<div class="math notranslate nohighlight">
\[dp = - \rho g_{h} dz\]</div>
<p>to be replaced by a constant gravity</p>
<div class="math notranslate nohighlight">
\[dp = - \rho g_{0} dz_{g}\]</div>
<p>providing</p>
<div class="math notranslate nohighlight">
\[dz_{g} = \frac{g_{h}}{g_{0}}dz\]</div>
<p>With Newtonâ€™s gravitational law this becomes</p>
<div class="math notranslate nohighlight">
\[dz_{g} = \frac{g}{g_{0}}\left(\frac{R}{R + z}\right)^2dz\]</div>
<p>And integrating this, considering that <span class="math notranslate nohighlight">\(z=0\)</span> and <span class="math notranslate nohighlight">\(z_{g}=0\)</span> at sea level, results in</p>
<div class="math notranslate nohighlight">
\[z_{g} = \frac{g}{g_{0}}\frac{Rz}{R + z}\]</div>
<div class="math notranslate nohighlight">
\[z = \frac{g_{0}Rz_{g}}{gR-g_{0}z_{g}}\]</div>
</div></blockquote>
</section>
<section id="gas-constant">
<h2>gas constant</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k\)</span></p></td>
<td><p>Boltzmann constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_A\)</span></p></td>
<td><p>Avogadro constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>universal gas constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K mol s^2}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Relation between Boltzmann constant, universal gas constant, and Avogadro constant:</p>
<div class="math notranslate nohighlight">
\[k = \frac{R}{N_A}\]</div>
</div></blockquote>
</section>
<section id="ideal-gas-law">
<h2>ideal gas law</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k\)</span></p></td>
<td><p>Boltzmann constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N\)</span></p></td>
<td><p>amount of substance</p></td>
<td><p><span class="math notranslate nohighlight">\(molec\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>universal gas constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K mol s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(V\)</span></p></td>
<td><p>volume</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[pV = \frac{NRT}{N_{A}} = NkT\]</div>
</div></blockquote>
</section>
<section id="barometric-formula">
<h2>barometric formula</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g_{0}\)</span></p></td>
<td><p>mean earth gravity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g_{h}\)</span></p></td>
<td><p>gravity at specific height</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k\)</span></p></td>
<td><p>Boltzmann constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{air}\)</span></p></td>
<td><p>molar mass of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N\)</span></p></td>
<td><p>amount of substance</p></td>
<td><p><span class="math notranslate nohighlight">\(molec\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_A\)</span></p></td>
<td><p>Avogadro constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>universal gas constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K mol s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(V\)</span></p></td>
<td><p>volume</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td><p>altitude</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(z_{g}\)</span></p></td>
<td><p>geopotential height</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\phi\)</span></p></td>
<td><p>latitude</p></td>
<td><p><span class="math notranslate nohighlight">\(degN\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>mass density</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span></p></td>
</tr>
</tbody>
</table>
<p>From the ideal gas law we have:</p>
<div class="math notranslate nohighlight">
\[p = \frac{NkT}{V} = \frac{10^{-3}NM_{air}}{VN_{a}}\frac{kTN_{a}}{10^{-3}M_{air}} = \rho\frac{RT}{10^{-3}M_{air}}\]</div>
<p>And from the hydrostatic assumption we get:</p>
<div class="math notranslate nohighlight">
\[dp = - \rho g_{h} dz\]</div>
<p>Dividing <span class="math notranslate nohighlight">\(dp\)</span> by <cite>p</cite> we get:</p>
<div class="math notranslate nohighlight">
\[\frac{dp}{p} = -\frac{10^{-3}M_{air}\rho g_{h} dz}{\rho RT} = -\frac{10^{-3}M_{air}g_{h}dz}{RT}\]</div>
<p>Integrating this expression from one pressure level to the next we get:</p>
<div class="math notranslate nohighlight">
\[p(i+1) = p(i)e^{-\int^{z(i+1)}_{z(i)}\frac{10^{-3}M_{air}g_{h}}{RT}dz}\]</div>
<p>We can approximate this further by using an average value of the height dependent quantities
<span class="math notranslate nohighlight">\(M_{air}\)</span>, <span class="math notranslate nohighlight">\(g_{h}\)</span> and <span class="math notranslate nohighlight">\(T\)</span> for the integration over the range <span class="math notranslate nohighlight">\([z(i),z(i+1)]\)</span>.
This gives:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   g' &amp; = &amp; g_{h}(\phi,\frac{z(i)+z(i+1)}{2}) \\
   p(i+1) &amp; = &amp; p(i)e^{-10^{-3}\frac{M_{air}(i)+M_{air}(i+1)}{2}\frac{2}{T(i)+T(i+1)}\frac{g'}{R}\left(z(i+1)-z(i)\right)} \\
          &amp; = &amp; p(i)e^{-10^{-3}\frac{M_{air}(i)+M_{air}(i+1)}{T(i)+T(i+1)}\frac{g'}{R}\left(z(i+1)-z(i)\right)}
\end{eqnarray}</div><p>When using geopotential height the formula is the same except that <span class="math notranslate nohighlight">\(g=g_{0}\)</span> at all levels:</p>
<div class="math notranslate nohighlight">
\[p(i+1) = p(i)e^{-10^{-3}\frac{M_{air}(i)+M_{air}(i+1)}{T(i)+T(i+1)}\frac{g_{0}}{R}\left(z_{g}(i+1)-z_{g}(i)\right)}\]</div>
</div></blockquote>
</section>
<section id="mass-density">
<h2>mass density</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N\)</span></p></td>
<td><p>amount of substance</p></td>
<td><p><span class="math notranslate nohighlight">\(molec\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_A\)</span></p></td>
<td><p>Avogadro constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{air}\)</span></p></td>
<td><p>molar mass of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(V\)</span></p></td>
<td><p>volume</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>mass density</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[\rho = \frac{10^{-3}NM_{air}}{VN_{a}}\]</div>
</div></blockquote>
</section>
<section id="number-density">
<h2>number density</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>number density</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N\)</span></p></td>
<td><p>amount of substance</p></td>
<td><p><span class="math notranslate nohighlight">\(molec\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(V\)</span></p></td>
<td><p>volume</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[n = \frac{N}{V}\]</div>
</div></blockquote>
</section>
<section id="dry-air-vs-total-air">
<h2>dry air vs. total air</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>number density of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{dry\_air}\)</span></p></td>
<td><p>number density of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{H_{2}O}\)</span></p></td>
<td><p>number density of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{air}\)</span></p></td>
<td><p>molar mass of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{dry\_air}\)</span></p></td>
<td><p>molar mass of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{H_{2}O}\)</span></p></td>
<td><p>molar mass of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>mass density of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\rho_{dry\_air}\)</span></p></td>
<td><p>mass density of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho_{H_{2}O}\)</span></p></td>
<td><p>mass density of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   n &amp; = &amp; n_{dry\_air} + n_{H_{2}O} \\
   M_{air}n &amp; = &amp; M_{dry\_air}n_{dry\_air} + M_{H_{2}O}n_{H_{2}O} \\
   \rho &amp; = &amp; \rho_{dry\_air} + \rho_{H_{2}O} \\
\end{eqnarray}</div></div></blockquote>
</section>
<section id="virtual-temperature">
<h2>virtual temperature</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k\)</span></p></td>
<td><p>Boltzmann constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K s^2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{air}\)</span></p></td>
<td><p>molar mass of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{dry\_air}\)</span></p></td>
<td><p>molar mass of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{H_{2}O}\)</span></p></td>
<td><p>molar mass of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N\)</span></p></td>
<td><p>amount of substance</p></td>
<td><p><span class="math notranslate nohighlight">\(molec\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_A\)</span></p></td>
<td><p>Avogadro constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(p_{dry\_air}\)</span></p></td>
<td><p>dry air partial pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p_{H_{2}O}\)</span></p></td>
<td><p>H2O partial pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>universal gas constant</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg m^2}{K mol s^2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T_{v}\)</span></p></td>
<td><p>virtual temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(V\)</span></p></td>
<td><p>volume</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3\)</span></p></td>
</tr>
</tbody>
</table>
<p>From the ideal gas law we have:</p>
<div class="math notranslate nohighlight">
\[p = \frac{NkT}{V} = \frac{10^{-3}NM_{air}}{VN_{a}}\frac{kTN_{a}}{10^{-3}M_{air}} = \rho \frac{RT}{10^{-3}M_{air}}\]</div>
<p>The virtual temperature allows us to use the dry air molar mass in this equation:</p>
<div class="math notranslate nohighlight">
\[p = \rho\frac{RT_{v}}{10^{-3}M_{dry\_air}}\]</div>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[T_{v} = \frac{M_{dry\_air}}{M_{air}}T\]</div>
</div></blockquote>
</section>
<section id="volume-mixing-ratio">
<h2>volume mixing ratio</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>number density of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{dry\_air}\)</span></p></td>
<td><p>number density of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{H_{2}O}\)</span></p></td>
<td><p>number density of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{x}\)</span></p></td>
<td><p>number density of quantity x</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\nu_{x}\)</span></p></td>
<td><p>volume mixing ratio of quantity
x with regard to total air</p></td>
<td><p><span class="math notranslate nohighlight">\(ppv\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\bar{\nu}_{x}\)</span></p></td>
<td><p>volume mixing ratio of quantity
x with regard to dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(ppv\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   \nu_{x} &amp; = &amp; \frac{n_{x}}{n} \\
   \bar{\nu}_{x} &amp; = &amp; \frac{n_{x}}{n_{dry\_air}} \\
   \nu_{dry\_air} &amp; = &amp; \frac{n_{dry\_air}}{n} =
      \frac{n - n_{H_{2}O}}{n} = 1 - \nu_{H_{2}O} \\
   \nu_{air} &amp; = &amp; \frac{n}{n} = 1 \\
   \bar{\nu}_{dry\_air} &amp; = &amp; \frac{n_{dry\_air}}{n_{dry\_air}} = 1 \\
   \bar{\nu}_{H_{2}O} &amp; = &amp; \frac{n_{H_{2}O}}{n_{dry\_air}} =
      \frac{\nu_{H_{2}O}}{\nu_{dry\_air}} = \frac{\nu_{H_{2}O}}{1 - \nu_{H_{2}O}} \\
   \nu_{H_{2}O} &amp; = &amp; \frac{\bar{\nu}_{H_{2}O}}{1 + \bar{\nu}_{H_{2}O}}
\end{eqnarray}</div></div></blockquote>
</section>
<section id="mass-mixing-ratio">
<h2>mass mixing ratio</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{air}\)</span></p></td>
<td><p>molar mass of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{dry\_air}\)</span></p></td>
<td><p>molar mass of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{x}\)</span></p></td>
<td><p>molar mass of quantity x</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>number density of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{dry\_air}\)</span></p></td>
<td><p>number density of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{H_{2}O}\)</span></p></td>
<td><p>number density of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{x}\)</span></p></td>
<td><p>number density of quantity x</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(q_{x}\)</span></p></td>
<td><p>mass mixing ratio of quantity x
with regard to total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{kg}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\bar{q}_{x}\)</span></p></td>
<td><p>mass mixing ratio of quantity x
with regard to dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{kg}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\nu_{x}\)</span></p></td>
<td><p>volume mixing ratio of quantity
x with regard to total air</p></td>
<td><p><span class="math notranslate nohighlight">\(ppv\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\bar{\nu}_{x}\)</span></p></td>
<td><p>volume mixing ratio of quantity
x with regard to dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(ppv\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   q_{x} &amp; = &amp; \frac{n_{x}M_{x}}{nM_{air}} = \nu_{x}\frac{M_{x}}{M_{air}} \\
   \bar{q}_{x} &amp; = &amp; \frac{n_{x}M_{x}}{n_{dry\_air}M_{dry\_air}} = \bar{\nu}_{x}\frac{M_{x}}{M_{dry\_air}} \\
   q_{dry\_air} &amp; = &amp; \frac{n_{dry\_air}M_{dry\_air}}{nM_{air}} =
      \frac{nM_{air} - n_{H_{2}O}M_{H_{2}O}}{nM_{air}} = 1 - q_{H_{2}O} \\
   q_{air} &amp; = &amp; \frac{nM_{air}}{nM_{air}} = 1 \\
   \bar{q}_{dry\_air} &amp; = &amp; \frac{n_{dry\_air}M_{dry\_air}}{n_{dry\_air}M_{dry\_air}} = 1 \\
   \bar{q}_{H_{2}O} &amp; = &amp; \frac{n_{H_{2}O}M_{H_{2}O}}{n_{dry\_air}M_{dry\_air}} =
      \frac{q_{H_{2}O}}{q_{dry\_air}} = \frac{q_{H_{2}O}}{1 - q_{H_{2}O}} \\
   q_{H_{2}O} &amp; = &amp; \frac{\bar{q}_{H_{2}O}}{1 + \bar{q}_{H_{2}O}}
\end{eqnarray}</div></div></blockquote>
</section>
<section id="molar-mass-of-total-air">
<h2>molar mass of total air</h2>
<ol class="arabic">
<li><p>molar mass of total air from H2O volume mixing ratio</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{air}\)</span></p></td>
<td><p>molar mass of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{dry\_air}\)</span></p></td>
<td><p>molar mass of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{H_{2}O}\)</span></p></td>
<td><p>molar mass of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>number density of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{dry\_air}\)</span></p></td>
<td><p>number density of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{H_{2}O}\)</span></p></td>
<td><p>number density of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\nu_{H_{2}O}\)</span></p></td>
<td><p>volume mixing ratio of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(ppv\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   M_{air} &amp; = &amp; \frac{M_{dry\_air}n_{dry\_air} + M_{H_{2}O}n_{H_{2}O}}{n} \\
           &amp; = &amp; M_{dry\_air}\left(1 - \nu_{H_{2}O}\right) + M_{H_{2}O}\nu_{H_{2}O}
\end{eqnarray}</div></li>
<li><p>molar mass of total air from H2O mass mixing ratio</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{air}\)</span></p></td>
<td><p>molar mass of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_{dry\_air}\)</span></p></td>
<td><p>molar mass of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_{H_{2}O}\)</span></p></td>
<td><p>molar mass of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{g}{mol}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>number density of total air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{dry\_air}\)</span></p></td>
<td><p>number density of dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{H_{2}O}\)</span></p></td>
<td><p>number density of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{molec}{m^3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(q_{H_{2}O}\)</span></p></td>
<td><p>mass mixing ratio of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{kg}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\nu_{H_{2}O}\)</span></p></td>
<td><p>volume mixing ratio of H2O</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{kg}{kg}\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   M_{air} &amp; = &amp; M_{dry\_air}\left(1 - \nu_{H_{2}O}\right) + M_{H_{2}O}\nu_{H_{2}O} \\
           &amp; = &amp; M_{dry\_air}\left(1 - \frac{M_{air}}{M_{H_{2}O}}q_{H_{2}O}\right) + M_{air}q_{H_{2}O} \\
           &amp; = &amp; \frac{M_{dry\_air}}{1 + \frac{M_{dry\_air}}{M_{H_{2}O}}q_{H_{2}O} - q_{H_{2}O}} \\
           &amp; = &amp; \frac{M_{H_{2}O}M_{dry\_air}}{M_{H_{2}O} + M_{dry\_air}q_{H_{2}O} - M_{H_{2}O}q_{H_{2}O}} \\
           &amp; = &amp; \frac{M_{H_{2}O}M_{dry\_air}}{\left(1-q_{H_{2}O}\right)M_{H_{2}O} + q_{H_{2}O}M_{dry\_air}} \\
\end{eqnarray}</div></li>
</ol>
</section>
<section id="partial-pressure">
<h2>partial pressure</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>total pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(p_{x}\)</span></p></td>
<td><p>partial pressure of quantity</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\nu_{x}\)</span></p></td>
<td><p>volume mixing ratio of quantity
x with regard to total air</p></td>
<td><p><span class="math notranslate nohighlight">\(ppv\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\bar{\nu}_{x}\)</span></p></td>
<td><p>volume mixing ratio of quantity
x with regard to dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(ppv\)</span></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   p_{x} &amp; = &amp; \nu_{x}p \\
   p_{x} &amp; = &amp; \bar{\nu}_{x}p_{dry\_air} \\
   p_{x} &amp; = &amp; N_{x}kT
\end{eqnarray}</div></div></blockquote>
</section>
<section id="saturated-water-vapor-pressure">
<h2>saturated water vapor pressure</h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(e_{w}\)</span></p></td>
<td><p>saturated water vapor pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
</tbody>
</table>
<p>This is the August-Roche-Magnus formula for the saturated water vapor pressure</p>
<div class="math notranslate nohighlight">
\[e_{w} = 610.94e^{\frac{17.625(T-273.15)}{(T-273.15)+243.04}}\]</div>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="definitions.html" class="btn btn-neutral float-left" title="Definitions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="regridding.html" class="btn btn-neutral float-right" title="Regridding operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2025 S[&amp;]T, The Netherlands.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>